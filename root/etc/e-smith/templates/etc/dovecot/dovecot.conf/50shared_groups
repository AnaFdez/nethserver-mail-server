#
# 50shared_groups -- Access to group-shared mailboxes
#
# The post-login script set disabled=no, on user's groups
#
{

    if($dovecot{SharedMailboxesStatus} ne 'enabled') {
	return '';
    }

    use esmith::AccountsDB;
    my $accountsDb = esmith::AccountsDB->open_ro() || die("Could not open AccountsDB");
    
    foreach my $group (map { $_->key } grep { 
	($_->prop('MailDeliveryType') || '') eq 'shared' 
		       } $accountsDb->groups()) {	       	
	$OUT .= qq(
namespace s-${group} {
  type = shared
  disabled = yes
  separator = /
  prefix = Shared/${group}
  location = maildir:/var/lib/nethserver/vmail/${group}/Maildir:INDEX=~/Maildir/shared/${group}
  subscriptions = no
  list = children
  mailbox {
     auto = subscribe
  }
}
);
    }

    return $OUT;
}


